{
  "type": "record",
  "name": "MeteringEvent",
  "namespace": "caracal.events",
  "doc": "Metering event for tracking resource usage",
  "fields": [
    {
      "name": "event_id",
      "type": "string",
      "doc": "Unique identifier for this event (UUID)"
    },
    {
      "name": "schema_version",
      "type": "int",
      "default": 1,
      "doc": "Schema version for backward compatibility"
    },
    {
      "name": "timestamp",
      "type": "long",
      "logicalType": "timestamp-millis",
      "doc": "Event timestamp in milliseconds since epoch"
    },
    {
      "name": "agent_id",
      "type": "string",
      "doc": "Agent identifier (UUID)"
    },
    {
      "name": "event_type",
      "type": {
        "type": "enum",
        "name": "EventType",
        "symbols": ["API_CALL", "MCP_TOOL", "DELEGATION"]
      },
      "doc": "Type of metering event"
    },
    {
      "name": "resource_type",
      "type": "string",
      "doc": "Type of resource consumed (e.g., 'openai.gpt-4', 'anthropic.claude-3')"
    },
    {
      "name": "resource_uri",
      "type": ["null", "string"],
      "default": null,
      "doc": "URI of the resource accessed"
    },
    {
      "name": "quantity",
      "type": "double",
      "doc": "Quantity of resource consumed (e.g., tokens, API calls)"
    },
    {
      "name": "unit",
      "type": "string",
      "default": "operation",
      "doc": "Unit of measurement (e.g., 'tokens', 'operations', 'requests')"
    },
    {
      "name": "parent_agent_id",
      "type": ["null", "string"],
      "default": null,
      "doc": "Parent agent ID for delegated operations"
    },
    {
      "name": "correlation_id",
      "type": ["null", "string"],
      "default": null,
      "doc": "Correlation ID for tracing related events"
    },
    {
      "name": "metadata",
      "type": {
        "type": "map",
        "values": "string"
      },
      "default": {},
      "doc": "Additional metadata as key-value pairs"
    }
  ]
}
